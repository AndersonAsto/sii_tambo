CREATE TABLE siit_tiendas(
    idTienda INT AUTO_INCREMENT PRIMARY KEY,
    codTienda VARCHAR(256) NOT NULL,

    tienda VARCHAR(256) NOT NULL,
    ubicacion VARCHAR(256) NOT NULL,
    distrito VARCHAR(256) NOT NULL,
    provincia VARCHAR(256) NOT NULL,
    departamento VARCHAR(256) NOT NULL,
    pais VARCHAR(256) NOT NULL,

    estado TINYINT(1) DEFAULT 1,
    createdAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updatedAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
) ENGINE = InnoDB;

CREATE TABLE siit_categorias(
    idCategoria INT AUTO_INCREMENT PRIMARY KEY,
    codCategoria VARCHAR(256),

    categoria VARCHAR(256) NOT NULL,

    estado TINYINT(1) NOT NULL DEFAULT 1,
    createdAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updatedAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
) ENGINE = InnoDB;

CREATE TABLE siit_subCategorias(
    idSubCategoria INT AUTO_INCREMENT PRIMARY KEY,
    codSubCategoria VARCHAR(256),
    idCategoria INT NOT NULL,

    subCategoria VARCHAR(256) NOT NULL,

    estado TINYINT(1) NOT NULL DEFAULT 1,
    createdAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updatedAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

    FOREIGN KEY (idCategoria) REFERENCES siit_categorias(idCategoria) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE = InnoDB;

CREATE TABLE siit_productos(
    idProducto INT AUTO_INCREMENT PRIMARY KEY,
    codProducto VARCHAR(256),

    producto VARCHAR(256) NOT NULL,
    precioAntiguo DECIMAL(10,2) NULL,
    precioNuevo DECIMAL(10,2) NOT NULL,
    descuento TINYINT UNSIGNED NULL,
    idCategoria INT NOT NULL,
    idSubCategoria INT NOT NULL,

    estado TINYINT(1) NOT NULL DEFAULT 1,
    createdAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updatedAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

    FOREIGN KEY (idCategoria) REFERENCES siit_categorias(idCategoria) ON DELETE CASCADE ON UPDATE CASCADE,
    FOREIGN KEY (idSubCategoria) REFERENCES siit_subCategorias(idSubCategoria) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE = InnoDB;

CREATE TABLE siit_usuarios(
    idUsuario INT AUTO_INCREMENT PRIMARY KEY,
    codUsuario VARCHAR(256),
    idTienda INT NOT NULL,

    email VARCHAR(256) NOT NULL,
    contrasenia VARCHAR(256) NOT NULL,

    estado TINYINT(1) NOT NULL DEFAULT 1,
    createdAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updatedAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

    FOREIGN KEY (idTienda) REFERENCES siit_tiendas(idTienda) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE = InnoDB;

CREATE TABLE siit_ventas(
    idVenta INT AUTO_INCREMENT PRIMARY KEY,
    idTienda INT NOT NULL,
    idUsuario INT NOT NULL,

    cantidadProductos INT NULL,
    total DECIMAL(10,2) NOT NULL,
    createdAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

    FOREIGN KEY (idTienda) REFERENCES siit_tiendas(idTienda) ON DELETE CASCADE,
    FOREIGN KEY (idUsuario) REFERENCES siit_usuarios(idUsuario) ON DELETE CASCADE
) ENGINE = InnoDB;

CREATE TABLE siit_detalle_ventas(
    idDetalle INT AUTO_INCREMENT PRIMARY KEY,
    idVenta INT NOT NULL,
    idProducto INT NOT NULL,
    cantidad INT NOT NULL,
    subtotal DECIMAL(10,2) NOT NULL,
    createdAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

    FOREIGN KEY (idVenta) REFERENCES siit_ventas(idVenta) ON DELETE CASCADE,
    FOREIGN KEY (idProducto) REFERENCES siit_productos(idProducto)
) ENGINE=InnoDB;
